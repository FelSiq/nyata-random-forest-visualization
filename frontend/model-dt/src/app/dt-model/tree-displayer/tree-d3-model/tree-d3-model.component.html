<mat-accordion>
  <mat-expansion-panel class="visual-settings-panel">
    <mat-expansion-panel-header>
      <mat-panel-title>
        <mat-icon class="visual-settings-panel-icon">view_headline</mat-icon>
        Visual settings
      </mat-panel-title>
    </mat-expansion-panel-header>
    <mat-toolbar color="primary">
      Toggle visible attributes
    </mat-toolbar>
    <mat-card>
      <mat-card-title>
        Node attributes
      </mat-card-title>
      <mat-card-content>
        <mat-selection-list #nodeAttrList
                            dense
                            (selectionChange)="nodeService.toggleAttr($event.option.value); nodeService.updateNodeLabel(nodes)">
          <mat-list-option *ngFor="let nodeAttr of nodeService.visibleAttrs"
                           color="primary"
                           [selected]="nodeService.activeAttrs.indexOf(nodeAttr) > -1"
                           [value]="nodeAttr">
            Show {{ (nodeAttr | titlecase).split('-').join(' ') }}
          </mat-list-option>
        </mat-selection-list>
      </mat-card-content>
    </mat-card>
    <mat-card>
      <mat-card-title>
        Link attributes
      </mat-card-title>
      <mat-card-content>
        <mat-selection-list #linkAttrList
                            dense
                            (selectionChange)="linkService.toggleAttr($event.option.value); linkService.updateLinkLabel(links)">
          <mat-list-option *ngFor="let linkAttr of linkService.visibleAttrs"
                           color="primary"
                           [selected]="linkService.activeAttrs.indexOf(linkAttr) > -1"
                           [value]="linkAttr">
            Show {{ (linkAttr | titlecase).split('-').join(' ') }}
          </mat-list-option>
        </mat-selection-list>
      </mat-card-content>
    </mat-card>
  </mat-expansion-panel>
</mat-accordion>

<mat-card>
  <mat-card-actions>
    <div>
      <mat-form-field class="current-tree-selector" *ngIf="treeNodes && treeNodes.length > 1">
        <mat-label class="forest-label">
          Current selected model from the forest (of size {{ treeNodes.length }}) to visualize:
        </mat-label>
        <mat-select [(ngModel)]="chosenTree" (ngModelChange)="changesHandler()">
          <mat-option *ngFor="let tree of treeNodes; index as i;"
                  value="{{ i }}">
                  {{ i + 1 }} (node count: {{ tree.tree_.value.node_count }}, depth: {{ tree.tree_.value.maximum_depth }})
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </mat-card-actions>
  
  <mat-card-content>
    <svg width="100%" height="512" class="current-tree-model"></svg>
  </mat-card-content>
  
  <mat-card-footer>
    <div>
      <span class="control-section-rotate">
        <mat-icon (click)="rotateTree(90)"
                  [style.cursor]="'pointer'"
                  class="rotate-icon">
          rotate_left
        </mat-icon>
        <mat-icon (click)="rotateTree(270)"
                  [style.cursor]="'pointer'"
                  class="rotate-icon">
          rotate_right
        </mat-icon>
      </span>
      <span class="control-section-zoom">
        <mat-icon (click)="updateZoomValue(-0.25)"
                  (dblclick)="updateZoomValue(-0.75)"
                  [style.cursor]="zoomValue <= zoomMin ? 'not-allowed' : 'pointer'"
                  class="zoom-icon">
          zoom_out
        </mat-icon>
        <mat-slider [min]="zoomMin"
                    [max]="zoomMax"
                    [(value)]="zoomValue"
                    step="0.01"
                    class="zoom-slider">
        </mat-slider>
        <mat-icon (click)="updateZoomValue(+0.25)"
                  (dblclick)="updateZoomValue(+0.75)"
                  [style.cursor]="zoomValue >= zoomMax ? 'not-allowed' : 'pointer'"
                  class="zoom-icon">
          zoom_in
        </mat-icon>
      </span>
    </div>
    
    <div *ngIf="treeNodes && (chosenTree || chosenTree === 0)">
      <mat-card>
        <mat-card-title>
          Current tree characteristics
        </mat-card-title>
    
        <mat-card-content>
          <mat-list>
            <span *ngFor="let attr of treeNodes[+chosenTree].tree_.value | keyvalue">
              <mat-list-item *ngIf="!attr.value.length">
                <strong>
                  {{ (attr.key | titlecase).split('_').join(' ') }}:
                </strong>
                {{ attr.value }}
              </mat-list-item>
            </span>
          </mat-list>
        </mat-card-content>
      </mat-card>
    </div>
  </mat-card-footer>
</mat-card>
